<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  <title>Document</title>

  <link rel="stylesheet" href="css.styles.css">
  <!-- <link rel="stylesheet" href="bootstrap_css/bootstrap.min.css"> -->
  <!-- jquery読み込み -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script defer src="/__/firebase/5.3.1/firebase-app.js"></script>
  <script defer src="/__/firebase/5.3.1/firebase-auth.js"></script>
  <script src="https://cdn.firebase.com/libs/firebaseui/3.1.1/firebaseui.js"></script>
  <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.1.1/firebaseui.css" />
  <script defer src="/__/firebase/init.js"></script>
</head>

<body>


  <div id="firebaseui-auth-container"></div>
  <div id="loader">Loading...</div>

  <p>※メールアドレス</p>
  <p>aaaa@gmail.com</p>
  <p>※パスワード</p>
  <p>aaaa1234</p>





  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase.js"></script>

  <script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
      apiKey: "",
      authDomain: "chat-sample-db906.firebaseapp.com",
      databaseURL: "https://chat-sample-db906.firebaseio.com",
      projectId: "chat-sample-db906",
      storageBucket: "chat-sample-db906.appspot.com",
      messagingSenderId: "233881950125",
      appId: "1:233881950125:web:0f52742b678ce7922b7324"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
  </script>

  <!-- //ログイン用 -->
  <script type="text/javascript">
    var ui = new firebaseui.auth.AuthUI(firebase.auth());

    var uiConfig = {
      callbacks: {
        signInSuccessWithAuthResult: function (authResult, redirectUrl) {
          return true;
        },
        uiShown: function () {
          document.getElementById('loader').style.display = 'none';
        }
      },
      signInFlow: 'popup',
      signInSuccessUrl: 'load.html',
      signInOptions: [
        firebase.auth.EmailAuthProvider.PROVIDER_ID,
      ],
    };
    ui.start('#firebaseui-auth-container', uiConfig);
  </script>

  <script>
    // // 日時をいい感じの形式にする関数
    // function convertFromFirestoreTimestampToDatetime(timestamp) {
    //   const _d = timestamp ? new Date(timestamp * 1000) : new Date();
    //   const Y = _d.getFullYear();
    //   const m = (_d.getMonth() + 1).toString().padStart(2, '0');
    //   const d = _d.getDate().toString().padStart(2, '0');
    //   const H = _d.getHours().toString().padStart(2, '0');
    //   const i = _d.getMinutes().toString().padStart(2, '0');
    //   const s = _d.getSeconds().toString().padStart(2, '0');
    //   return `${Y}/${m}/${d} ${H}:${i}:${s}`;
    // }
    // // データベースの設定を記述
    // // 受信処理の記述
    // //orderBy()googleの関数
    // db.orderBy('time', 'desc').onSnapshot(function (querySnapshot) {
    //   // onSnapshotでcloud firestoreのデータ変更時に実行される！
    //   // querySnapshot.docsにcloud firestoreのデータが配列形式で入る
    //   const dataArray = []; // 必要なデータだけが入った新しい配列を作成
    //   querySnapshot.docs.forEach(function (doc) {
    //     console.log(doc);
    //     console.log(doc.id);
    //     // console.log(doc.data);
    //     //data()はドキュメントの内容を取得するgoogleの関数
    //     console.log(doc.data());
    //     const data = {
    //       id: doc.id,
    //       data: doc.data(),
    //     }
    //     dataArray.push(data);
    //   });
    //   const tagArray = []; 
    //   dataArray.forEach(function (data) {
    //     tagArray.push(`
    //           <li id=${data.id}>
    //           <p>${data.data.name}</p>
    //           <p>${data.data.text}</p>
    //           <p>${convertFromFirestoreTimestampToDatetime(data.data.time.seconds)}</p>
    //           </li>
    //           `)
    //   })
    //   $('#output').html(tagArray);

    // });

    // データをリアルタイムに取得する処理
    // db.orderBy('time', 'desc').onSnapshot(function (querySnapshot) {
    //   // まずはconsole.log()で出力してデータの形を確認！
    //   console.log()
    // });

    firebase.auth().createUserWithEmailAndPassword(email, password).catch(function (error) {
      // Handle Errors here.
      var errorCode = error.code;
      var errorMessage = error.message;
      // ...
    }); email - password.html

    firebase.auth().signInWithEmailAndPassword(email, password).catch(function (error) {
      // Handle Errors here.
      var errorCode = error.code;
      var errorMessage = error.message;
      // ...
    }); email - password.html

    firebase.auth().onAuthStateChanged(function (user) {
      if (user) {
        // User is signed in.
        var displayName = user.displayName;
        var email = user.email;
        var emailVerified = user.emailVerified;
        var photoURL = user.photoURL;
        var isAnonymous = user.isAnonymous;
        var uid = user.uid;
        var providerData = user.providerData;
        localStorage.setItem("id", uid);
        // ...
      } else {
        // User is signed out.
        // ...
      }
    });


  </script>

  <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->

  <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
  <script src="/__/firebase/7.23.0/firebase-app.js"></script>

  <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
  <script src="/__/firebase/7.23.0/firebase-analytics.js"></script>

  <!-- Add Firebase products that you want to use -->
  <script src="/__/firebase/7.23.0/firebase-auth.js"></script>
  <script src="/__/firebase/7.23.0/firebase-firestore.js"></script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="js/main.js"></script>
  <script src="/__/firebase/init.js"></script>
</body>

</html>